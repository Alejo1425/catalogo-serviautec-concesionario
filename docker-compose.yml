version: '3.8'

services:
  # Instancia para Juan (Asesor real)
  auteco-juan:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_ASESOR_ID: juan
    container_name: auteco-juan
    restart: unless-stopped
    networks:
      - traefik_proxy
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=traefik_proxy"
      - "traefik.http.routers.auteco-juan.rule=Host(`juan.autorunai.tech`)"
      - "traefik.http.routers.auteco-juan.entrypoints=websecure"
      - "traefik.http.routers.auteco-juan.tls=true"
      - "traefik.http.routers.auteco-juan.tls.certresolver=mytlschallenge"
      - "traefik.http.services.auteco-juan.loadbalancer.server.port=80"

  # Instancia por defecto
  auteco-default:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_ASESOR_ID: default
    container_name: auteco-default
    restart: unless-stopped
    networks:
      - traefik_proxy
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=traefik_proxy"
      - "traefik.http.routers.auteco-default.rule=Host(`autorunai.tech`) || Host(`www.autorunai.tech`)"
      - "traefik.http.routers.auteco-default.entrypoints=websecure"
      - "traefik.http.routers.auteco-default.tls=true"
      - "traefik.http.routers.auteco-default.tls.certresolver=mytlschallenge"
      - "traefik.http.services.auteco-default.loadbalancer.server.port=80"

networks:
  traefik_proxy:
    external: true
